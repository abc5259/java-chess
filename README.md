# java-chess

체스 미션 저장소

# 체스 3, 4단계 미션 - 체스판 초기화

## 1. 기능 요구사항
- 콘솔 UI에서 체스 게임을 할 수 있는 기능을 구현한다.
- 1단계는 체스 게임을 할 수 있는 체스판을 초기화한다.
- 체스판에서 말의 위치 값은 가로 위치는 왼쪽부터 a ~ h이고, 세로는 아래부터 위로 1 ~ 8로 구현한다.
- `move source위치 target위치`을 실행해 이동한다.
- 체스판에서 각 진영은 검은색(대문자)과 흰색(소문자) 편으로 구분한다.
---
- 체스 게임은 상대편 King이 잡히는 경우 게임에서 진다. King이 잡혔을 때 게임을 종료해야 한다.
- 체스 게임은 현재 남아 있는 말에 대한 점수를 구할 수 있어야 한다.
- "status" 명령을 입력하면 각 진영의 점수를 출력하고 어느 진영이 이겼는지 결과를 볼 수 있어야 한다.
- ---
- 애플리케이션을 재시작하더라도 이전에 하던 체스 게임을 다시 시작할 수 있어야 한다.
- DB를 적용할 때 도메인 객체의 변경을 최소화해야한다.
- ---
```
RNBQKBNR  8 (rank 8)
PPPPPPPP  7
........  6
........  5
........  4
........  3
pppppppp  2
rnbqkbnr  1 (rank 1)

abcdefgh
```
**점수 계산 규칙**
- 체스 프로그램에서 현재까지 남아 있는 말에 따라 점수를 계산할 수 있어야 한다.
- 각 말의 점수는 queen은 9점, rook은 5점, bishop은 3점, knight는 2.5점이다.
- pawn의 기본 점수는 1점이다. 하지만 같은 세로줄에 같은 색의 폰이 있는 경우 1점이 아닌 0.5점을 준다.
- king은 잡히는 경우 경기가 끝나기 때문에 점수가 없다.
- 한 번에 한 쪽의 점수만을 계산해야 한다.

- **체스 용어 정리**
> **file(파일)**: 체스판의 세로줄, a ~ h로 표현된다.
> 
> **rank(랭크)**: 체스판의 가로줄, 1 ~ 8로 표현된다.
> 
> **square(스퀘어)**: 체스 판에 존재하는 하나의 칸을 의미한다. 총 64칸이 존재한다.
> 
> **take(테이크)**: 체스 말이 다른 진영의 말을 잡는 것을 의미한다.

**체스판 기보: FEN**

- 포사이스-에드워드 표기법(Forsyth-Edwards Notation, 줄여서 FEN)은 포지션을 기록하는 가장 쉬운 방법입니다.
- 현재 체스판 상태(기물의 위치, 현재 턴, 캐슬링, 앙파상 가능 여부 등)을 한 줄의 문자열로 나타내는 공식 체스 기보 표현법.
- [FEN이란?](https://www.chess.com/ko/terms/fen-chess-ko)
- 데이터베이스에 딱 하나의 열로 표현 가능한 장점이 있다.
- 데이터베이스에 체스판 정보를 FEN을 이용하여 저장. 

## 2. 기능 목록


### 2-1. 입력
- [x] 게임 시작을 위한 `start` 입력 받기
- [x] 게임 종료를 위한 `end` 입력 받기
- [x] 점수 계산을 위한 `status` 입력 받기
- [x] 게임 진행을 위한 `move source위치 target위치` 입력 받기
  - [x] 정해진 게임 Command 입력인지 검증

### 2-2. 메인 로직 실행

- [x] 체스 말(Piece)를 생성하여 체스판 위에 배치한다.
  - [x] 체스 말(Piece)을 정해진 규칙에 따라 배치한다.
  - [x] 체스 말(Piece)를 흑/백 구분하여 배치한다.
  - [x] 체스 말(Piece)을 종류별로 생성한다.
- [x] 체스 말(Piece)를 이동시킨다.
  - [x] 흑/백이 번갈아가며 이동 명령을 내릴 수 있다.
  - [x] 모든 체스 말은 정해진 이동 규칙에 따라 이동 여부가 결정된다.
    - [x] 이동 경로에 Piece가 존재하는 경우, 이동이 제한된다.
      - [x] Knight Piece의 경우는 제외한다.
    - [x] 도착점에 기물이 있는 경우, 움직임을 판단한다. 
      - [x] 상대 진영의 기물인 경우, 상대 진영의 기물을 take를 한다.
      - [x] 같은 진영의 기물인 경우, 이동이 제한된다.
    - [x] `Check`를 당한 경우, `Check`를 해소할 수 있는 이동만 허용된다.
      - [x] 어떤 이동으로도 해소할 수 없으면 `Check Mate`로 게임이 종료된다.
  - [x] 각 진영 별 현재 점수를 계산한다.
    - [x] 각 기물은 각자의 점수가 지정되어있다.
    - [x] pawn의 경우, 같은 `file`에 같은 색깔의 pawn이 존재한다면 개당 0.5점으로 계산한다.
  - [x] Check Mate를 당한다면 점수와 관계없이 패한다.

  - [x] 현재 체스판을 데이터베이스에 저장한다.
    - [x] 프로그램을 종료해도 마지막 게임을 불러온다.
      - [x] 저장된 게임 기록이 존재하면 게임을 이어서 재개한다.
    - [x] 경기를 `end` 명령어로 끝나게 되면 현재 체스판과 차례를 저장한다.
    - [x] 경기가 체크메이트로 종료되면 데이터베이스를 초기화한다.

### 2-3. 출력
- [x] 입력 가능한 Command 설명 프롬프트 출력한다.
- [x] 생성된 초기 체스판을 출력한다.
  - [x] 상단에는 흑이, 하단에는 백이 위치하도록 한다.
  - [x] 흑은 알파벳 대문자로, 백은 알파벳 소문자로 표현한다.
  - [x] 체스 말이 존재하지 않는 곳은 `.`으로 표현한다.
- [x] 이동 결과를 출력한다.
  - [x] 가능한 이동이 아니면 오류 문구를 출력한다. 
- [x] 현재 각 진영의 점수와 승패를 출력한다.
- [x] 현재 저장된 기보가 있다면 게임을 기보를 기준으로 이어서 재개한다.

## 2. 실행 결과

```
> 체스 게임을 시작합니다.
> 게임 시작 : start
> 게임 종료 : end
> 게임 이동 : move source위치 target위치 - 예. move b2 b3
> 현재 점수 출력 : status
start
RNBQKBNR
PPPPPPPP
........
........
........
........
pppppppp
rnbqkbnr

move b2 b3
RNBQKBNR
PPPPPPPP
........
........
........
.p......
p.pppppp
rnbqkbnr

```

